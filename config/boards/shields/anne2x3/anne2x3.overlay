/*
 * Copyright (c) 2024 The ZMK Contributors
 *
 * SPDX-License-Identifier: MIT
 */

/ {
    chosen {
        zmk,kscan = &default_kscan;
        zmk,underglow = &led_strip; // Añadido para RGB
    };

    default_kscan: kscan {
        compatible = "zmk,kscan-gpio-direct";
        label = "default_kscan";
        input-gpios =
            <&pro_micro 1  (GPIO_ACTIVE_LOW | GPIO_PULL_UP)>,  // posición lógica 0
            <&pro_micro 0  (GPIO_ACTIVE_LOW | GPIO_PULL_UP)>,  // posición lógica 1
            <&pro_micro 2  (GPIO_ACTIVE_LOW | GPIO_PULL_UP)>,  // posición lógica 2
            <&pro_micro 3  (GPIO_ACTIVE_LOW | GPIO_PULL_UP)>,  // posición lógica 3
            <&pro_micro 4  (GPIO_ACTIVE_LOW | GPIO_PULL_UP)>,  // posición lógica 4
            <&pro_micro 5  (GPIO_ACTIVE_LOW | GPIO_PULL_UP)>;  // posición lógica 5
    };
};

// --- Sección para LEDs WS2812B usando driver GPIO ---
// La etiqueta "led_strip" es la importante para 'chosen'.
// El nombre del nodo (aquí "ws2812_leds") es solo un identificador local.
led_strip: ws2812_leds { 
    compatible = "worldsemi,ws2812-gpio";
    label = "WS2812_LEDS"; // Etiqueta descriptiva para el dispositivo
    chain-length = <6>; /* Número de LEDs */
    
    // Usando directamente &gpio0 para el pin P0.20 de la Nice!Nano.
    // P0.20 es el pin 20 en el controlador gpio0.
    // Flags = 0 (para salida estándar, activa alta).
    gpios = <&gpio0 20 0>; 

    color-mapping = <LED_COLOR_ID_GREEN LED_COLOR_ID_RED LED_COLOR_ID_BLUE>; // Mapeo GRB para WS2812B
};
// --- Fin de la sección de LEDs ---